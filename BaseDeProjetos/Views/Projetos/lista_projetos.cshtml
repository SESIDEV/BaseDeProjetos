@model IEnumerable<BaseDeProjetos.Models.Projeto>
@using BaseDeProjetos.Helpers
@{
    var usuarios = ViewData["Usuarios"] as List<Usuario>;
}

<style>
    .caixa-logo {
        max-width: 180px;
        height: 100%;
        justify-content: center;
        align-items: center;
        padding: 20px;
    }
    
    #box-btn-actions {
        width: 100%;
        justify-content: center;
        gap: 10px;
    }
</style>


@foreach (var projeto in Model)
{
    <div id="modalEditProjeto-@projeto.Id-container">
    </div>

    <div id="modalDeleteProjeto-@projeto.Id-container">
    </div>

    <div id="modalHistoryProjeto-@projeto.Id-container">
    </div>

    <div id="modalDetailsProjeto-@projeto.Id-container">
    </div>

    <div id="modalIncluirIndicadorProjeto-@projeto.Id-container">
    </div>

    <div id="modalDetalhesIndicadorProjeto-@projeto.Id-container">
    </div>

    <tr>
        <td class="cell">
            <div class="d-flex gap-2 flex-column align-items-center">
                <div>
                    @*LOGO*@
                    @if (projeto.Empresa.Logo != null)
                    {
                        <img style="border: 2px solid #999; border-radius: 10px;" loading="lazy" src="@projeto.Empresa.Logo" id="logoEmpresa" alt="Logo da Empresa" style="background-color:white" width="175%" />
                    }
                    else
                    {
                        <nobr id="logo_alt">Sem Logo</nobr>
                    }
                </div>
                <div style="text-align:center;width:90px">
                    @*NOME EMPRESA*@
                    @projeto.Empresa.Nome @*FAVOR NAO EDITAR*@
                </div>
            </div>
        </td>
        
        <td class="cell">
            @projeto.NomeProjeto
        </td>
        <td class="cell">
            @if (projeto.Usuario != null)
            {
                <span class="badge bg-success">@projeto.Usuario.UserName</span> @*Líder*@
            }
            else
            {
                <span class="badge bg-danger">Sem Líder</span>
            }
            @if (projeto.MembrosEquipe != null)
            {
                foreach (var item in projeto.MembrosEquipe.Split(";"))
                {
                    if (item != "")
                    {
                        var user = usuarios.Where(u => u.Email == item).FirstOrDefault();
                        if (user != null)
                        {
                            <span class="badge bg-info">@user.UserName</span>
                        }
                    }
                }
            }
        </td>
        <td class="cell">
            @projeto.Status.GetDisplayName()
        </td>
        <td class="cell">
            @if (projeto.ValorAporteRecursos != 0 && projeto.ValorAporteRecursos > 0)
            {
                <span> R$ @Helpers.FormatarValoresDashboards((decimal)projeto.ValorAporteRecursos)</span>
            }
            else
            {
                <span>A preencher</span>
            }
        </td>
        <td class="cell">
            @projeto.FonteFomento.GetDisplayName()
        </td>
        <td class="cell">
            <span>@projeto.DataInicio.ToString("dd/MM/yyyy")</span>
        </td>
        <td class="cell">
            <span>@projeto.DataEncerramento.ToString("dd/MM/yyyy")</span>
        </td>
        <td class="cell">
            <span>69%</span>
        </td>
        <td class="cell">
            <button type="button" data-bs-target="#modalDetalhes-@projeto.Id" id="button-@projeto.Id" data-bs-toggle="modal" class="btn-sm app-btn-primary" onmouseover="carregarModaisProjeto('@projeto.Id')">Detalhes</button>
        </td>
    </tr>
}